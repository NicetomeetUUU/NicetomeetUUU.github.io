---
title: "技术文档部分记录"
date: 2024-03-08
description: "制定路由表与数据库"
type: "post"
tags: ["blog", "go项目"]
---

<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->
<!-- **Table of Contents**  *generated with [DocToc](https://github.com/thlorenz/doctoc)* -->

- [1 数据库设计](#1-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1)
  - [1.1 country表](#11-country%E8%A1%A8)
  - [1.2 school表](#12-school%E8%A1%A8)
  - [1.3 item表](#13-item%E8%A1%A8)
  - [1.4 user表](#14-user%E8%A1%A8)
  - [1.5 系统设置表](#15-%E7%B3%BB%E7%BB%9F%E8%AE%BE%E7%BD%AE%E8%A1%A8)
- [2 路由表及功能详情如下](#2-%E8%B7%AF%E7%94%B1%E8%A1%A8%E5%8F%8A%E5%8A%9F%E8%83%BD%E8%AF%A6%E6%83%85%E5%A6%82%E4%B8%8B)
  - [2.1 country相关：](#21-country%E7%9B%B8%E5%85%B3)
  - [2.2 school相关：](#22-school%E7%9B%B8%E5%85%B3)
  - [2.3 item相关：](#23-item%E7%9B%B8%E5%85%B3)
  - [2.4 user相关：](#24-user%E7%9B%B8%E5%85%B3)
  - [2.5 system相关](#25-system%E7%9B%B8%E5%85%B3)

<!-- END doctoc generated TOC please keep comment here to allow auto update -->
## 1 数据库设计
- 数据库整体暂定一年一版，每年新建一个数据库，上一年数据库封存；
### 1.1 country表
- 包含字段：
    - 主键countryId，int整数； 
    - 国家英文名countryEngName，可变长字符，非空；
    - 国家中文名countryChiName，可变长字符，非空；
    - 国家与学校关联字段，JSON类型，内存int类型数组保存schoolId信息；
    - 省字段，JSON类型，内存Province类数组，保存具体省份信息；
- Province类包含属性：
    - ProvinceId，int整数；
    - EngName，省英文名，string；
    - ChiName，省中文名，string；
### 1.2 school表
- 包含字段：
    - 主键schoolId，int整数；
    - 学校英文名：schoolEngName，可变长字符，非空；
    - 学校中文名：schoolChiName，可变长字符，非空；
    - 学校简介：schoolAbbreviation，可变长字符；
    - 学校类型：schoolType，int类型；
    - 所在省份：province，int类型，对应provinceId；
    - 官方网站：officialWebLink，可变长字符，非空；
    - 备注：schoolRemark，可变长字符；
    - 学校与项目关联字段：JSON，内存int类型数组，保存itemId信息；
### 1.3 item表
- 包含字段：
    - 主键itemId，int整数；
    - 项目名称itemName，可变长字符，非空；
    - 描述level文字，可变长字符，非空；
    - level占比，JSON，内存Level类型数组，保存level信息；
    - itemRemark项目备注，string类型；
- Level类包含属性：
    - levelId，int整数；
    - levelRate，占比，string类型
    - ifNotCombine，判断是否存在该等级用户属性，bool类型；
### 1.4 user表
- 包含字段；
    - 主键userId，int类型；
    - 用户账户userAccount，可变长字符，非空；
    - 用户密码userPassWd，可变长字符；
    - 用户邮箱userEmail，可变长字符；
    - 用户电话userNumber，可变长字符，非空；
    - 用户等级userLevel，int类型，非空；
    - 学生数量studentCount，int类型；
### 1.5 系统设置表
- 包含字段：
    - systemId，主键int；
    - maxUserLevel，最大用户等级，非空
    - schoolTypeList，学校类型列表，JSON，内存SchoolType类型数组
- SchoolType类属性：
    - SchoolTypeId，编号，int类型；
    - SchoolTypeName，学校类型名称，string类型；

## 2 路由表及功能详情如下
### 2.1 country相关：
- 添加country：（可编辑状态下，添加国家按钮触发，会增加一个空白条目）
  - URL：192.168.10.17:9001/country/create?pageNum=0
  - 请求方式：Get
  - 请求参数：无
  - 详细功能：
    - 添加一个空白的country条目；
- 查看country：（国家管理按钮跳转触发）
  - URL：192.168.10.17:9001/country/show
  - 请求方式：Post
  - 请求参数：
    - pageNum（int，一页显示数据条数）、page（int，当前所在的页数）；
  - 详细功能：
    - 按页列出当前所有country条目信息
- 删除country：（指定条目尾部的删除按钮触发）
  - URL：192.168.10.17:9001/country/delete
  - 请求方式：DELETE
  - 请求参数：
    - countryId（int，主键）、listIndex（int，前端表中当前条目的位置）
  - 详细功能：
    - 删除选定的country条目信息
- 修改country：（可编辑状态下，填写文本框即触发）
  - URL：192.168.10.17:9001/country/changeCountry
  - 请求方式：Post
  - 请求参数：
    - countryId（int， 主键）、修改字段英文名（库名）
  - 详细功能：
    - 修改选定的country条目信息
- 修改province：（弹窗界面）
  - URL：192.168.10.17:9001/country/changeProvince/show
    - 请求方式：Post
    - 请求参数：countryId、listindex；
    - 详细功能
      - 转到弹窗编辑页面
  - URL：192.168.10.17:9001/country/changeProvince/save
    - 请求方式：Post
    - 请求参数：
      - countryId、修改的信息、listindex；
    - 详细功能：
      - 保存修改的信息
- 编辑school跳转：（跳转到school）
  - URL：192.168.10.17:9001/country/editSchool
  - 请求方式：Post
  - 请求参数：countryId、listIndex、countryChiName、page、pageNum；
  - 详细功能：
    - 从指定的条目跳转到school，并在下拉菜单指定好国家中文名；
    - 且给出当前所有国家中文名；
### 2.2 school相关：
- 转到school：（学校管理按钮触发）
  - URL：192.168.10.17:9001/school/initPage
  - 请求方式：Get
  - 请求参数：无
  - 详细功能：
    - 跳转到school；
    - 且给出当前所有国家中文名；
- 选择国家：（选择国家下拉菜单触发）（暂弃用）
  - URL：192.168.10.17:9001/school/selectCountry
  - 请求方式：Get
  - 请求参数：无
  - 详细功能：
    - 请求后端返回所有可选择的countryChiName和countryId；
- 查看school：（选择国家下拉菜单，选择国家后触发）
  - URL：192.168.10.17:9001/school/show
    - 更新：复用了country/editSchool路由，没用到本URL；
  - 请求方式：Post
  - 请求参数：
    - countryChiName（选定的国家中文名）
    - pageNum（int，每页显示的数据条数）、page（int，当前所在的页数）
  - 详细功能：
    - 将选择国家相关的所有school信息列表展示；
- 添加school：（可编辑状态下，创建学校按钮触发）
  - URL：192.168.10.17:9001/school/create
  - 请求方式：Post
    - 请求参数：countryListIndex、pageNum;
  - 详细功能：
    - 在表上增加一个school空白栏目用于编辑；
- 删除school：（指定条目尾部删除按钮触发）
  - URL：192.168.10.17:9001/school/delete
  - 请求方式：Post
  - 请求参数：
    - schoolId（int， 学校Id）、schoolListIndex、countryListIndex；
  - 详细功能：
    - 删除一个学校的信息；
- 修改school：（可编辑状态下，填写文本即触发）
  - URL：192.168.10.17:9001/school/change
  - 请求方式：Post
  - 请求参数：
    - schoolId、修改的信息、schoolListIndex、countryListIndex；
  - 详细功能：
    - 修改指定school条目的信息
- 编辑item转到：（跳转到item）
  - URL：192.168.10.17:9001/school/editItem
  - 请求方式：Post
  - 请求参数：countryListIndex、schoolListIndex、page、pageNum；
  - 详细功能：
    - 从指定的条目跳转到school，并在下拉菜单指定好国家中文名；
    - 且给出当前所有国家中文名；
### 2.3 item相关：
- 转到item：（项目管理按钮触发）
  - URL：192.168.10.17:9001/school/initPage（复用了school initpage路由，功能差不多）
  - 请求方式：Get
  - 请求参数：无
  - 详细功能：
    - 跳转到item（清除原界面内容）；
    - 给出当前所有国家的中文名；
- 选择国家：（下拉菜单点击选定的国家后触发）
  - URL：192.168.10.17:9001/item/selectCountry
  - 请求方式：Get
  - 请求参数：无
  - 详细功能：
    - 获取当前后端所有国家给下拉菜单用；
    - 需要countryChiName和countryId；
- 获取学校：（点击选定的国家后触发）
  - URL：192.168.10.17:9001/item/getSchool?countryListIndex=0
  - 请求方式：Get
  - 请求参数：无
  - 详细功能：
    - 获取当前国家的所有school；
    - 需要后端给出countryListIndex；
- 查看item：（选择学校下拉菜单，选择学校后触发）
  - URL：192.168.10.17:9001/school/editItem（复用了school editItem，功能相似）
  - 请求方式：Post
  - 请求参数：
    - schoolChiName（选定的国家中文名）
    - pageNum（int，每页显示的数据条数）、page（int，当前所在的页数）
  - 详细功能：
    - 将选择学校相关的所有item信息列表展示；
- 添加item：（可编辑状态下，创建项目按钮触发）
  - URL：192.168.10.17:9001/item/create
  - 请求方式：POST
  - 请求参数：countryListIndex, schoolListIndex, pageNum
  - 详细功能：
    - 在表上增加一个item空白栏目用于编辑；
- 删除item：（指定条目尾部删除按钮触发）
  - URL：192.168.10.17:9001/item/delete
  - 请求方式：DELETE
  - 请求参数：
    - itemId（int， 项目Id）、listIndex（int，前端表中当前条目的位置）
  - 详细功能：
    - 删除一个项目的信息；
- 修改item：（可编辑状态下，填写文本框即触发）
  - URL：192.168.10.17:9001/item/change
  - 请求方式：Post
  - 请求参数：
    - itemId、修改的信息
  - 详细功能：
    - 修改指定item条目的信息
- 编辑项目比例：（弹窗，编辑按钮触发）
  - URL：192.168.10.17:9001/item/change/show
    - 请求方式：Post
    - 请求参数：itemId、listindex；
    - 详细功能
      - 转到项目比例编辑页面
  - URL：192.168.10.17:9001/item/changeProportion/save
    - 请求方式：Post
    - 请求参数：
      - itemId、listindex、修改的信息
    - 详细功能：
      - 保存修改的信息
- 编辑项目比例弹窗内保存按键：
  - URL：192.168.10.17:9001/item/changeProportion/save
    - 请求方式：Post
    - 请求参数：countryListIndex、schoolListIndex、itemListIndex；
    - 详细功能：
      - 保存弹窗内编辑的内容
### 2.4 user相关：
- 查看user：（用户管理按钮触发）
  - URL：192.168.10.17:9001/user/show
  - 请求方式：Post
  - 请求参数：
    - pageNum（int，一页显示数据条数）、page（int，当前所在的页数）；
  - 详细功能：
    - 按页列出当前所有country条目信息
- 添加user：（添加用户按钮触发）
  - URL：192.168.10.17:9001/user/create?pageNum=0
  - 请求方式：Get
  - 请求参数：无
  - 详细功能：
    - 跳转到用户添加页面；
- 修改user：（可编辑状态下，选定条目的编辑按钮触发）
  - URL：192.168.10.17:9001/user/changeUser
  - 请求方式：Post
  - 请求参数：条目所有信息、userId；
  - 详细功能：
    - 对选定条目用户信息做修改；
- 删除user：（可编辑状态下，选定条目的编辑按钮触发）
  - URL：192.168.10.17:9001/user/delete
  - 请求方式：DELETE
  - 请求参数：
    - userId（int，主键）、listIndex（int，前端表中当前条目的位置）
  - 详细功能：
    - 删除选定条目用户信息；
### 2.5 system相关
- 查看system：
  - URL：192.168.10.17:9001/system/show
  - 请求方式：Get
  - 功能：显示system
- 创建system：
  - URL：192.168.10.17:9001/system/create
  - 请求方式：Get
  - 功能：新建一个空白system
- 删除system：
  - URL：192.168.10.17:9001/system/delete
  - 请求方式：DELETE
  - 请求参数：listIndex
  - 功能：删除选定的system
- 修改system：
  - URL：192.168.10.17:9001/system/change
  - 请求方式：POST
  - 请求参数：listIndex、updateField、updateValue；
  - 功能：修改选定system的信息